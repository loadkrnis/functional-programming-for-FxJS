<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>
			[QnA] 이제 비동기는 async:await으로 제어할 수 있는데 왜 파이프라인이
			필요한지?
		</title>
	</head>
	<body>
		<script src="./lib/fx.js"></script>
		<script>
			// 파이프라인은 연속적인 실행과 함수 실행을 조합하고 테스트하기 쉽고 유지보수하기 쉽게 만듭니다.
			// 비동기적인 로직을 문장으로 풀어서 작성하고 싶을 때 사용합니다.

			function delayI(a) {
				return new Promise((resolve) => setTimeout(() => resolve(a), 10));
			}

			function f5() {
				return go(
					[1, 2, 3, 4, 5, 6, 7, 8],
					L.map((a) => delayI(a * a)),
					L.filter((a) => delayI(a % 2)),
					L.map((a) => delayI(a + 1)),
					take(2),
					reduce((a, b) => delayI(a + b))
				);
			}
			go(f5(), console.log);

			async function f6() {
				const temp = [];
				const list = [1, 2, 3, 4, 5, 6, 7, 8];
				for (const a of list) {
					const b = await delayI(a * a);
					if (await delayI(b % 2)) {
						const c = await delayI(b + 1);
						temp.push(c);
					}
				}
				return temp;
			}
			go(f6(), console.log);
		</script>
	</body>
</html>
